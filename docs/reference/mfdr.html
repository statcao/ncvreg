<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Marginal false discovery rates — mfdr • ncvreg</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>
<meta property="og:title" content="Marginal false discovery rates — mfdr" />

<meta property="og:description" content="Estimates the marginal false discovery rate (mFDR) of a penalized
  regression model." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ncvreg</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">3.10.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/models.html">Models</a>
    </li>
    <li>
      <a href="../articles/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="../articles/inference-local.html">Inference: Local mfdr</a>
    </li>
    <li>
      <a href="../articles/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pbreheny/ncvreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Marginal false discovery rates</h1>
    
    <div class="hidden name"><code>mfdr.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Estimates the marginal false discovery rate (mFDR) of a penalized
  regression model.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mfdr</span>(<span class='no'>fit</span>, <span class='no'>X</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>fit</th>
      <td><p>An <code>ncvreg</code> or <code>ncvsurv</code> object.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>The model matrix corresponding to <code>fit</code>.  This is not
    necessary for linear regression, but in logistic and Cox regression,
    the mFDR depends on X.  It is not necessary to supply <code>X</code> if it
    is already contained in <code>fit</code>; i.e., if
    <code>ncvreg</code>/<code>ncvsurv</code> was run with <code>returnX=TRUE</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function estimates the marginal false discovery rate (mFDR) for a
  penalized regression model.  The estimate tends to be accurate in most
  settings, but will be slightly conservative if predictors are highly
  correlated.  For an alternative way of estimating the mFDR, typically more
  accurate in highly correlated cases,  see <code><a href='perm.ncvreg.html'>perm.ncvreg</a></code>.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>mfdr</code> inheriting from <code>data.frame</code> and
  containing:</p>
<dt>EF</dt><dd><p>The number of variables selected at each value of
    <code>lambda</code>, averaged over the permutation fits.</p></dd>
  <dt>S</dt><dd><p>The actual number of selected variables for the non-permuted
    data.</p></dd>
  <dt>mFDR</dt><dd><p>The estimated marginal false discovery rate (<code>EF/S</code>).</p></dd>
  
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ncvreg.html'>ncvreg</a></code>, <code><a href='ncvsurv.html'>ncvsurv</a></code>, <code><a href='plot-mfdr.html'>plot.mfdr</a></code>,
  <code><a href='perm.ncvreg.html'>perm.ncvreg</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Linear regression --------------------------------</span>
<span class='fu'>data</span>(<span class='no'>Prostate</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ncvreg.html'>ncvreg</a></span>(<span class='no'>Prostate</span>$<span class='no'>X</span>, <span class='no'>Prostate</span>$<span class='no'>y</span>)

<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'>mfdr</span>(<span class='no'>fit</span>)
<span class='no'>obj</span>[<span class='fl'>1</span>:<span class='fl'>10</span>,]</div><div class='output co'>#&gt;                   EF S         mFDR
#&gt; 0.84343 0.000000e+00 0 0.000000e+00
#&gt; 0.78658 1.418692e-11 1 1.418692e-11
#&gt; 0.73357 3.642789e-11 1 3.642789e-11
#&gt; 0.68413 1.098086e-10 1 1.098086e-10
#&gt; 0.63802 3.833845e-10 1 3.833845e-10
#&gt; 0.59502 1.516932e-09 1 1.516932e-09
#&gt; 0.55492 6.608721e-09 1 6.608721e-09
#&gt; 0.51752 3.065378e-08 1 3.065378e-08
#&gt; 0.48264 1.460789e-07 1 1.460789e-07
#&gt; 0.45011 6.907848e-07 1 6.907848e-07</div><div class='input'>
<span class='co'># Comparison with perm.ncvreg</span>
<span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'>plot</span>(<span class='no'>obj</span>)
<span class='fu'>plot</span>(<span class='no'>obj</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>)
<span class='no'>pmfit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='perm.ncvreg.html'>perm.ncvreg</a></span>(<span class='no'>Prostate</span>$<span class='no'>X</span>, <span class='no'>Prostate</span>$<span class='no'>y</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>) <span class='co'># Note that mfdr() is more conservative</span></div><div class='img'><img src='mfdr-1.png' alt='' width='480' height='480' /></div><div class='input'>
<span class='co'># Logistic regression ------------------------------</span>
<span class='fu'>data</span>(<span class='no'>Heart</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ncvreg.html'>ncvreg</a></span>(<span class='no'>Heart</span>$<span class='no'>X</span>, <span class='no'>Heart</span>$<span class='no'>y</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'>mfdr</span>(<span class='no'>fit</span>)
<span class='fu'>head</span>(<span class='no'>obj</span>)</div><div class='output co'>#&gt;                   EF S         mFDR
#&gt; 0.17746 0.000000e+00 0 0.000000e+00
#&gt; 0.16550 6.893422e-13 1 6.893422e-13
#&gt; 0.15435 2.683651e-11 1 2.683651e-11
#&gt; 0.14394 6.329530e-10 1 6.329530e-10
#&gt; 0.13424 9.776334e-09 1 9.776334e-09
#&gt; 0.12519 1.054851e-07 1 1.054851e-07</div><div class='input'><span class='fu'>plot</span>(<span class='no'>obj</span>)
<span class='fu'>plot</span>(<span class='no'>obj</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>)

<span class='co'># Cox regression -----------------------------------</span>
<span class='fu'>data</span>(<span class='no'>Lung</span>)
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='ncvsurv.html'>ncvsurv</a></span>(<span class='no'>Lung</span>$<span class='no'>X</span>, <span class='no'>Lung</span>$<span class='no'>y</span>)
<span class='no'>obj</span> <span class='kw'>&lt;-</span> <span class='fu'>mfdr</span>(<span class='no'>fit</span>)
<span class='fu'>head</span>(<span class='no'>obj</span>)</div><div class='output co'>#&gt;                   EF S         mFDR
#&gt; 0.44806 0.000000e+00 0 0.000000e+00
#&gt; 0.41786 9.926598e-06 1 9.926598e-06
#&gt; 0.38970 3.996605e-05 1 3.996605e-05
#&gt; 0.36344 1.392150e-04 1 1.392150e-04
#&gt; 0.33894 4.272559e-04 1 4.272559e-04
#&gt; 0.31610 1.173937e-03 1 1.173937e-03</div><div class='input'><span class='fu'>plot</span>(<span class='no'>obj</span>)
<span class='fu'>plot</span>(<span class='no'>obj</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>)</div><div class='img'><img src='mfdr-2.png' alt='' width='480' height='480' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;, with contributions from
  Ryan Miller &lt;ryan-e-miller@uiowa.edu&gt;
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

