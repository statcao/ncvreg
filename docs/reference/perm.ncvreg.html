<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Permutation fitting for ncvreg — perm.ncvreg • ncvreg</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  <script src="../extra.js"></script>
<meta property="og:title" content="Permutation fitting for ncvreg — perm.ncvreg" />

<meta property="og:description" content="Fits multiple penalized regression models in which the outcome is
  randomly permuted, thereby allowing estimation of the false inclusion rate." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ncvreg</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">3.10.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/models.html">Models</a>
    </li>
    <li>
      <a href="../articles/penalties.html">Penalties</a>
    </li>
    <li>
      <a href="../articles/inference-local.html">Inference: Local mfdr</a>
    </li>
    <li>
      <a href="../articles/inference-mfdr.html">Inference: Marginal false discovery rates</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pbreheny/ncvreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Permutation fitting for ncvreg</h1>
    
    <div class="hidden name"><code>perm.ncvreg.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Fits multiple penalized regression models in which the outcome is
  randomly permuted, thereby allowing estimation of the false inclusion rate.</p>
    
    </div>

    <pre class="usage"><span class='fu'>perm.ncvreg</span>(<span class='no'>X</span>, <span class='no'>y</span>, <span class='no'>...</span>, <span class='kw'>permute</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='st'>"outcome"</span>, <span class='st'>"residuals"</span>), <span class='kw'>N</span><span class='kw'>=</span><span class='fl'>10</span>, <span class='no'>seed</span>,
  <span class='kw'>trace</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>X</th>
      <td><p>The design matrix, without an intercept, as in <code>ncvreg</code>.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>The response vector, as in <code>ncvreg</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to <code>ncvreg</code>.</p></td>
    </tr>
    <tr>
      <th>permute</th>
      <td><p>What to permute.  If <code>'outcome'</code>, the response vector,
    <code>y</code>, is permuted.  If <code>'residuals'</code>, the residuals are permuted.
    This is only available for linear regression (i.e., for
    <code>family='gaussian'</code>).  Note that permuting the residuals may take a
    long time, as the residuals differ for each value of <code>lambda</code>, so
    separate permutations are required at every value of <code>lambda</code>.  See
    also <code><a href='permres.html'>permres</a></code>.</p></td>
    </tr>
    <tr>
      <th>N</th>
      <td><p>The number of permutation replications.  Default is 10.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>You may set the seed of the random number generator in
    order to obtain reproducible results.</p></td>
    </tr>
    <tr>
      <th>trace</th>
      <td><p>If set to TRUE, perm.ncvreg will inform the user of its progress
  by announcing the beginning of each permutation fit. Default is FALSE.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function fits a penalized regression model to the actual data,
  then repeats the process <code>N</code> times with a permuted version of the
  response vector.  This allows estimation of the expected number of
  variables included by chance for each value of <code>lambda</code>.  The
  ratio of this expected quantity to the number of selected variables
  using the actual (non-permuted) response is called the marginal false
  discovery rate (mFDR).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object with S3 class <code>"perm.ncvreg"</code> containing:</p>
<dt>EF</dt><dd><p>The number of variables selected at each value of
    <code>lambda</code>, averaged over the permutation fits.</p></dd>
  <dt>S</dt><dd><p>The actual number of selected variables for the non-permuted
    data.</p></dd>
  <dt>mFDR</dt><dd><p>The estimated marginal false discovery rate (<code>EF/S</code>).</p></dd>
  <dt>fit</dt><dd><p>The fitted <code>ncvreg</code> object for the original
    (non-permuted) data.</p></dd>
  <dt>loss</dt><dd><p>The loss/deviance for each value of <code>lambda</code>,
    averaged over the permutation fits.  This is an estimate of the
    explanatory power of the model under null conditions, and can be
    used to adjust the loss of the fitted model in a manner akin to
    the idea of an adjusted R-squared in classical regression.</p></dd>
  
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='ncvreg.html'>ncvreg</a></code>, <code><a href='plot-mfdr.html'>plot.mfdr</a></code>, <code><a href='mfdr.html'>mfdr</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Linear regression --------------------------------------------------</span>
<span class='fu'>data</span>(<span class='no'>Prostate</span>)
<span class='no'>pmfit</span> <span class='kw'>&lt;-</span> <span class='fu'>perm.ncvreg</span>(<span class='no'>Prostate</span>$<span class='no'>X</span>, <span class='no'>Prostate</span>$<span class='no'>y</span>)

<span class='fu'>par</span>(<span class='kw'>mfcol</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'>plot</span>(<span class='no'>pmfit</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>$<span class='no'>fit</span>)
<span class='no'>lam</span> <span class='kw'>&lt;-</span> <span class='no'>pmfit</span>$<span class='no'>fit</span>$<span class='no'>lambda</span>

<span class='no'>pmfit.r</span> <span class='kw'>&lt;-</span> <span class='fu'>perm.ncvreg</span>(<span class='no'>Prostate</span>$<span class='no'>X</span>, <span class='no'>Prostate</span>$<span class='no'>y</span>, <span class='kw'>permute</span><span class='kw'>=</span><span class='st'>'residuals'</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit.r</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"red"</span>)              <span class='co'># Permuting residuals is</span></div><div class='input'><span class='fu'>lines</span>(<span class='no'>lam</span>, <span class='no'>pmfit</span>$<span class='no'>mFDR</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"gray60"</span>)  <span class='co'># less conservative</span></div><div class='img'><img src='perm.ncvreg-1.png' alt='' width='480' height='480' /></div><div class='input'>
<span class='co'># Logistic regression ------------------------------------------------</span>
<span class='fu'>data</span>(<span class='no'>Heart</span>)
<span class='no'>pmfit</span> <span class='kw'>&lt;-</span> <span class='fu'>perm.ncvreg</span>(<span class='no'>Heart</span>$<span class='no'>X</span>, <span class='no'>Heart</span>$<span class='no'>y</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"binomial"</span>)

<span class='fu'>par</span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fl'>2</span>,<span class='fl'>2</span>))
<span class='fu'>plot</span>(<span class='no'>pmfit</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"EF"</span>)
<span class='fu'>plot</span>(<span class='no'>pmfit</span>$<span class='no'>fit</span>)</div><div class='img'><img src='perm.ncvreg-2.png' alt='' width='480' height='480' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    Patrick Breheny &lt;patrick-breheny@uiowa.edu&gt;
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

